#N canvas 4 171 1850 873 10;
#X obj 321 44 inlet start/stop;
#X obj 321 66 s \$0-strtStop;
#X text 38 322 Arg 1: internal bpm on or off;
#X text 328 19 start stop;
#X text 1086 477 multiply 24 ppq midi clock by 15 to get 360 ppq;
#X text 37 174 This metronome outputs 360 ticks per beat numbered 0-359.
If Ableton LINK session or MIDI clock is present it will latch onto
those \, otherwise it uses internal clock. It uses link object to also
generate the internal clock. It takes tempo and start/stop input and
outputs ticks 0-359;
#X text 37 268 It also outputs the tempo and clock source useful for
display purposes.;
#X text 67 693 the clockfix object ensures there are always 360 ticks
numbered 0-359. This is necessary when tempos increases to the point
where a tick is shorter than a dsp cycle in Pd (otherwise some numbers
get skipped). also necessary for lower resolution clock sources like
midi clock. it doesn't interpolate \, but does ensure we always get
0-359 no matter what goes in.;
#X obj 553 358 * 360;
#X obj 553 410 i;
#X obj 508 73 moses 10;
#X obj 1001 37 midirealtimein;
#X text 1317 78 MIDI 248 = clock \; 250 = start \; 251 = continue.
252 = stop;
#X obj 1001 88 sel 248 250 251 252 254, f 38;
#X obj 508 10 inlet tempo;
#X obj 553 272 spigot 0;
#X obj 598 242 r \$0-strtStop;
#X obj 1086 503 r link-session-present;
#X obj 553 839 outlet beat-clock;
#X obj 801 789 outlet Tempo;
#N canvas 303 750 292 294 mstobpm 0;
#X obj 46 14 inlet;
#X obj 47 248 outlet;
#X obj 46 108 t b b;
#X obj 46 79 sel 0;
#X text 87 47 time 16th notes;
#X obj 46 145 timer;
#X obj 46 46 % 12;
#X msg 46 176 30000 \$1;
#X obj 46 197 /;
#X connect 0 0 6 0;
#X connect 2 0 5 0;
#X connect 2 1 5 1;
#X connect 3 0 2 0;
#X connect 5 0 7 0;
#X connect 6 0 3 0;
#X connect 7 0 8 0;
#X connect 8 0 1 0;
#X restore 903 635 pd mstobpm;
#X obj 948 687 r midi-clock-present;
#X obj 903 715 spigot 0;
#N canvas 465 318 729 612 average-bpm 0;
#X obj 98 20 inlet;
#X obj 251 189 t a b;
#X obj 48 185 array sum \$0-bpm-mean;
#X obj 98 42 t b a;
#X obj 48 229 + 0.499999;
#X obj 48 251 i;
#X obj 48 273 outlet;
#X obj 284 11 loadbang;
#X msg 284 33 const 120;
#X obj 251 280 array set \$0-bpm-mean 5;
#X obj 48 207 / 5;
#X obj 284 58 array define -k \$0-bpm-mean 5;
#A 0 120 120 120 120 120;
#X obj 318 246 cg-loop 5 1;
#X connect 0 0 3 0;
#X connect 1 0 9 0;
#X connect 1 1 12 0;
#X connect 2 0 10 0;
#X connect 3 0 2 0;
#X connect 3 1 1 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 7 0 8 0;
#X connect 8 0 11 0;
#X connect 10 0 4 0;
#X connect 12 0 9 1;
#X restore 903 658 pd average-bpm;
#X obj 1310 263 delay 1000;
#X msg 1207 266 1;
#X obj 1001 201 t b b b b, f 52;
#X msg 1310 238 stop;
#X msg 1238 266 0;
#X obj 1234 399 s midi-clock-present;
#X obj 1001 325 spigot 0;
#X obj 1033 481 * 15;
#X obj 1033 531 i;
#X obj 1033 553 spigot 0;
#X obj 1086 528 ==;
#X obj 634 309 ==;
#X obj 634 287 r midi-clock-present;
#X obj 1158 114 s midi-stop;
#X obj 1053 173 s midi-start;
#X obj 1470 343 midiout;
#X obj 1416 249 r midi-ticks;
#X msg 1416 271 248;
#X obj 1416 197 r midi-start;
#X obj 1106 143 s midi-cont;
#X obj 1470 278 r midi-cont;
#X msg 1470 300 251;
#X msg 1416 219 250;
#X obj 1547 199 r midi-stop;
#X msg 1547 221 252;
#X text 1445 170 clock through and out;
#X obj 1324 690 outlet Clock-source;
#X obj 553 334 spigot 1, f 12;
#X obj 553 438 t f b;
#X obj 595 444 r link-session-present;
#X obj 580 510 sel 0 1, f 23;
#X obj 580 642 s \$0-clock-source;
#X obj 1324 602 r \$0-clock-source;
#X obj 580 476 f 0;
#X obj 553 717 clockfix;
#X obj 1060 628 s \$0-clock-source;
#X obj 1033 575 t f b;
#X msg 1060 605 2;
#X msg 697 588 3;
#X obj 1324 643 change -1;
#X obj 801 761 change -1;
#X obj 553 179 f;
#X obj 581 83 r midi-clock-present;
#X obj 607 108 r link-session-present;
#X obj 581 135 sel 0;
#N canvas 33 50 815 554 LINK 0;
#X msg 355 126 tempo \$1;
#X msg 144 127 resolution \$1;
#X msg 247 147 reset \$1 \$2;
#X obj 180 199 abl_link~ 1 0 4 134;
#X msg 59 125 connect \$1;
#X obj 510 209 r #abl_link_num_peers;
#X obj 32 45 loadbang;
#X obj 32 67 delay 100;
#X obj 217 244 wrap;
#X obj 285 31 inlet;
#X obj 291 233 i;
#X obj 217 306 outlet;
#X obj 291 255 outlet;
#X obj 510 261 > 0;
#X obj 510 283 s link-session-present;
#X msg 32 88 1;
#X connect 0 0 3 0;
#X connect 1 0 3 0;
#X connect 2 0 3 0;
#X connect 3 1 8 0;
#X connect 3 3 10 0;
#X connect 4 0 3 0;
#X connect 5 0 13 0;
#X connect 6 0 7 0;
#X connect 7 0 15 0;
#X connect 8 0 11 0;
#X connect 9 0 0 0;
#X connect 10 0 12 0;
#X connect 13 0 14 0;
#X connect 15 0 4 0;
#X restore 553 210 pd LINK - - - - - - - - - - - - -;
#X obj 580 549 f \$1;
#X msg 580 593 4;
#X obj 580 570 sel 0 1, f 12;
#X msg 620 594 1;
#X obj 1001 449 t f f;
#X text 1484 590 1 = internal bpm(set by og knob);
#X text 1484 650 4 = Hidden default bpm(off);
#X obj 801 409 spigot 1, f 12;
#X obj 1513 695 sel 1 2 3 4;
#X msg 1604 743 0;
#X msg 1513 745 1;
#X obj 1513 785 s metro-state;
#X obj 553 739 t f f;
#X obj 580 765 % 15;
#X obj 580 787 sel 0;
#X obj 580 809 s midi-ticks;
#X text 1484 610 2 = MIDI BPM;
#X text 1484 630 3 = LINK BPM;
#X obj 1407 429 loadbang;
#X obj 1407 450 \$1;
#X obj 1407 526 s \$0-clock-source;
#X msg 1407 492 1;
#X obj 1407 471 sel 1 0;
#X msg 1436 492 4;
#X obj 918 254 r midi-start;
#X msg 918 275 0;
#X obj 1001 387 cg-loop 24 1;
#X obj 1247 312 + 1;
#X obj 1247 333 == 1;
#X obj 1207 311 f 1;
#X obj 1207 362 t a a;
#X connect 0 0 1 0;
#X connect 8 0 9 0;
#X connect 9 0 52 0;
#X connect 10 1 65 0;
#X connect 11 0 13 0;
#X connect 13 0 26 0;
#X connect 13 1 38 0;
#X connect 13 2 43 0;
#X connect 13 3 37 0;
#X connect 14 0 10 0;
#X connect 15 0 51 0;
#X connect 16 0 15 1;
#X connect 17 0 34 0;
#X connect 20 0 23 0;
#X connect 21 0 22 1;
#X connect 22 0 64 0;
#X connect 23 0 22 0;
#X connect 24 0 28 0;
#X connect 25 0 99 0;
#X connect 26 0 30 0;
#X connect 26 1 24 0;
#X connect 26 2 25 0;
#X connect 26 3 27 0;
#X connect 27 0 24 0;
#X connect 28 0 99 0;
#X connect 30 0 96 0;
#X connect 31 0 32 0;
#X connect 32 0 33 0;
#X connect 33 0 60 0;
#X connect 34 0 33 1;
#X connect 35 0 51 1;
#X connect 35 0 77 1;
#X connect 36 0 35 0;
#X connect 40 0 41 0;
#X connect 41 0 39 0;
#X connect 42 0 46 0;
#X connect 44 0 45 0;
#X connect 45 0 39 0;
#X connect 46 0 39 0;
#X connect 47 0 48 0;
#X connect 48 0 39 0;
#X connect 51 0 8 0;
#X connect 52 0 58 0;
#X connect 52 1 57 0;
#X connect 53 0 57 1;
#X connect 54 0 70 0;
#X connect 54 1 62 0;
#X connect 56 0 63 0;
#X connect 57 0 54 0;
#X connect 58 0 82 0;
#X connect 60 0 58 0;
#X connect 60 1 61 0;
#X connect 61 0 59 0;
#X connect 62 0 55 0;
#X connect 63 0 50 0;
#X connect 63 0 78 0;
#X connect 64 0 19 0;
#X connect 65 0 69 0;
#X connect 66 0 68 0;
#X connect 67 0 68 0;
#X connect 68 0 65 0;
#X connect 69 0 15 0;
#X connect 69 1 77 0;
#X connect 70 0 72 0;
#X connect 71 0 55 0;
#X connect 72 0 71 0;
#X connect 72 1 73 0;
#X connect 73 0 55 0;
#X connect 74 0 20 0;
#X connect 74 1 31 0;
#X connect 77 0 64 0;
#X connect 78 0 80 0;
#X connect 78 1 80 0;
#X connect 78 2 80 0;
#X connect 78 3 79 0;
#X connect 79 0 81 0;
#X connect 80 0 81 0;
#X connect 82 0 18 0;
#X connect 82 1 83 0;
#X connect 83 0 84 0;
#X connect 84 0 85 0;
#X connect 88 0 89 0;
#X connect 89 0 92 0;
#X connect 91 0 90 0;
#X connect 92 0 91 0;
#X connect 92 1 93 0;
#X connect 93 0 90 0;
#X connect 94 0 95 0;
#X connect 95 0 96 2;
#X connect 96 0 74 0;
#X connect 97 0 98 0;
#X connect 98 0 99 1;
#X connect 99 0 97 0;
#X connect 99 0 100 0;
#X connect 100 0 30 1;
#X connect 100 1 29 0;
