#N canvas 4 50 1891 851 12;
#X obj 321 91 s \$0-strtStop;
#X text 38 307 Arg 1: internal bpm on or off;
#X text 363 68 start stop;
#X text 37 159 This metronome outputs 360 ticks per beat numbered 0-359.
If Ableton LINK session or MIDI clock is present it will latch onto
those \, otherwise it uses internal clock. It uses link object to also
generate the internal clock. It takes tempo and start/stop input and
outputs ticks 0-359;
#X text 37 253 It also outputs the tempo and clock source useful for
display purposes.;
#X obj 553 423 * 360;
#X obj 553 445 i;
#X obj 500 128 moses 10;
#X obj 1001 52 midirealtimein;
#X text 1317 93 MIDI 248 = clock \; 250 = start \; 251 = continue.
252 = stop;
#X obj 1001 103 sel 248 250 251 252 254, f 38;
#X obj 553 327 spigot 0;
#X obj 606 297 r \$0-strtStop;
#X obj 1087 570 r link-session-present;
#N canvas 317 398 292 451 mstobpm 0;
#X obj 46 14 inlet;
#X obj 46 284 outlet;
#X obj 46 108 t b b;
#X obj 46 79 sel 0;
#X text 87 47 time 16th notes;
#X obj 46 145 timer;
#X obj 46 46 % 12;
#X obj 46 182 expr 30000 / $f1;
#X obj 46 224 i;
#X obj 46 203 * 10;
#X obj 46 245 / 10;
#X connect 0 0 6 0;
#X connect 2 0 5 0;
#X connect 2 1 5 1;
#X connect 3 0 2 0;
#X connect 5 0 7 0;
#X connect 6 0 3 0;
#X connect 7 0 9 0;
#X connect 8 0 10 0;
#X connect 9 0 8 0;
#X connect 10 0 1 0;
#X restore 889 728 pd mstobpm;
#X obj 934 784 r midi-clock-present;
#X obj 889 812 spigot 0;
#N canvas 465 318 729 612 average-bpm 0;
#X obj 98 20 inlet;
#X obj 360 226 + 1;
#X obj 251 189 t a b;
#X obj 330 224 f 0;
#X obj 48 185 array sum \$0-bpm-mean;
#X obj 98 42 t b a;
#X obj 48 321 outlet;
#X obj 284 11 loadbang;
#X msg 284 33 const 120;
#X obj 251 280 array set \$0-bpm-mean 5;
#X obj 48 207 / 5;
#X obj 330 246 % 5;
#X obj 284 58 array define -k \$0-bpm-mean 5;
#A 0 120 120 120 120 120;
#X obj 48 249 i;
#X obj 48 228 * 10;
#N canvas 4 50 450 300 if-change-send 0;
#X obj 37 37 inlet;
#X obj 64 90 swap;
#X obj 64 111 -, f 5;
#X obj 64 132 abs;
#X obj 64 174 sel 1;
#X obj 37 58 t f f f, f 27;
#X obj 65 207 f;
#X obj 65 228 outlet;
#X obj 64 154 >= 2;
#X connect 0 0 5 0;
#X connect 1 0 2 0;
#X connect 1 1 2 1;
#X connect 2 0 3 0;
#X connect 3 0 8 0;
#X connect 4 0 6 0;
#X connect 5 0 1 1;
#X connect 5 1 1 0;
#X connect 5 2 6 1;
#X connect 6 0 7 0;
#X connect 8 0 4 0;
#X restore 48 291 pd if-change-send;
#X obj 48 270 / 10;
#X connect 0 0 5 0;
#X connect 1 0 3 1;
#X connect 2 0 9 0;
#X connect 2 1 3 0;
#X connect 3 0 1 0;
#X connect 3 0 11 0;
#X connect 4 0 10 0;
#X connect 5 0 4 0;
#X connect 5 1 2 0;
#X connect 7 0 8 0;
#X connect 8 0 12 0;
#X connect 10 0 14 0;
#X connect 11 0 9 1;
#X connect 13 0 16 0;
#X connect 14 0 13 0;
#X connect 15 0 6 0;
#X connect 16 0 15 0;
#X restore 889 755 pd average-bpm;
#X obj 1173 274 delay 1000;
#X obj 1001 219 t b b b b, f 25;
#X msg 1173 249 stop;
#X obj 1147 390 s midi-clock-present;
#X obj 1002 401 spigot 0;
#X obj 1034 618 spigot 0;
#X obj 1087 593 ==;
#X obj 634 360 ==;
#X obj 634 335 r midi-clock-present;
#X obj 1197 175 s midi-stop;
#X obj 1053 192 s midi-start;
#X obj 1470 398 midiout;
#X obj 1416 304 r midi-ticks;
#X msg 1408 329 248;
#X obj 1416 252 r midi-start;
#X obj 1106 158 s midi-cont;
#X obj 1470 333 r midi-cont;
#X msg 1470 355 251;
#X msg 1416 274 250;
#X obj 1547 254 r midi-stop;
#X msg 1547 276 252;
#X text 1445 225 clock through and out;
#X obj 553 389 spigot 1, f 12;
#X obj 553 482 t f b;
#X obj 603 492 r link-session-present;
#X obj 585 584 sel 0 1, f 23;
#X obj 585 724 s \$0-clock-source;
#X obj 1304 727 r \$0-clock-source;
#X obj 585 520 f 0;
#X obj 518 565 clockfix;
#X obj 1066 703 s \$0-clock-source;
#X obj 1034 640 t f b;
#X obj 1304 768 change -1;
#X obj 553 234 f;
#X obj 581 128 r midi-clock-present;
#X obj 606 153 r link-session-present;
#X obj 581 190 sel 0;
#N canvas 310 162 795 548 LINK 0;
#X msg 355 126 tempo \$1;
#X msg 144 127 resolution \$1;
#X msg 247 147 reset \$1 \$2;
#X obj 247 126 pack f f;
#X obj 59 105 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X obj 180 199 abl_link~ 1 0 4 134;
#X floatatom 355 107 5 0 0 2 tempo - -;
#X floatatom 292 107 5 0 0 2 quantum - -;
#X floatatom 247 107 5 0 0 2 beat - -;
#X floatatom 144 107 5 0 0 2 resolution - -;
#X msg 59 125 connect \$1;
#X floatatom 510 231 5 0 0 0 - - -;
#X obj 510 209 r #abl_link_num_peers;
#X obj 32 45 loadbang;
#X obj 32 67 delay 100;
#X obj 217 297 wrap;
#X obj 285 31 inlet;
#X obj 217 359 outlet;
#X obj 291 249 outlet;
#X obj 510 261 > 0;
#X obj 510 283 s link-session-present;
#X obj 237 69 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X connect 0 0 5 0;
#X connect 1 0 5 0;
#X connect 2 0 5 0;
#X connect 3 0 2 0;
#X connect 4 0 10 0;
#X connect 5 1 15 0;
#X connect 5 3 18 0;
#X connect 6 0 0 0;
#X connect 7 0 3 1;
#X connect 8 0 3 0;
#X connect 9 0 1 0;
#X connect 10 0 5 0;
#X connect 11 0 19 0;
#X connect 12 0 11 0;
#X connect 13 0 14 0;
#X connect 14 0 4 0;
#X connect 15 0 17 0;
#X connect 16 0 6 0;
#X connect 19 0 20 0;
#X connect 21 0 8 0;
#X restore 553 265 pd LINK - - - - - - - - - - - - -;
#X obj 585 644 sel 0 1, f 12;
#X obj 1002 505 t f f;
#X text 1464 735 1 = internal bpm(set by og knob);
#X text 1464 795 4 = Hidden default bpm(off);
#X obj 781 464 spigot 1, f 12;
#X obj 1534 549 sel 1 2 3 4;
#X obj 1534 639 s metro-state;
#X obj 553 834 t f f;
#X obj 580 858 % 15;
#X obj 580 880 sel 0;
#X obj 580 902 s midi-ticks;
#X text 1464 755 2 = MIDI BPM;
#X text 1464 775 3 = LINK BPM;
#X obj 1325 443 loadbang;
#X obj 1325 571 s \$0-clock-source;
#X obj 1325 509 sel 1 0, f 11;
#X obj 1034 537 midiclocker;
#X text 51 541 the clockfix object ensures there are always 360 ticks
numbered 0-359. This is necessary when tempos increases to the point
where a tick is shorter than a dsp cycle in Pd (otherwise some numbers
get skipped).;
#X text 1119 538 24 ppq in \, 360 ppq out;
#X obj 1115 347 t a a;
#X obj 1053 165 t b b;
#X obj 553 934 outlet;
#X text 605 934 beat-clock;
#X obj 779 889 outlet;
#X text 829 889 Tempo;
#X obj 500 65 inlet;
#X text 545 61 tempo;
#X obj 321 69 inlet;
#X obj 783 50 inlet;
#X obj 783 78 route reStart sync, f 20;
#X obj 783 112 s \$0-reS;
#N canvas 4 50 450 300 count24 0;
#X obj 244 204 outlet;
#X obj 74 8 inlet;
#X obj 141 22 inlet;
#X obj 126 67 f;
#X obj 212 68 + 1;
#X obj 265 119 t b;
#X obj 265 140 0;
#X obj 212 170 t f f;
#X obj 212 93 moses 24;
#X connect 1 0 3 0;
#X connect 2 0 3 1;
#X connect 3 0 4 0;
#X connect 4 0 8 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 3 1;
#X connect 7 1 0 0;
#X connect 8 0 7 0;
#X connect 8 1 5 0;
#X restore 1002 453 pd count24;
#X obj 851 112 s \$0-r-sync;
#X obj 1197 139 t b b;
#X obj 779 861 t a;
#X obj 1069 426 i -1;
#X obj 1173 298 0;
#X obj 1115 294 1;
#X obj 1304 815 outlet;
#X text 1302 843 Clock Source;
#X obj 1534 602 1;
#X obj 1589 602 0;
#X obj 700 670 i 3;
#X obj 585 671 i 4;
#X obj 585 617 i \$1;
#X obj 625 672 i 1;
#X obj 1066 670 i 2;
#X obj 1325 476 i \$1;
#X obj 1362 538 i 4;
#X obj 1325 537 i 1;
#X connect 5 0 6 0;
#X connect 6 0 41 0;
#X connect 7 1 51 0;
#X connect 8 0 10 0;
#X connect 10 0 19 0;
#X connect 10 1 76 0;
#X connect 10 2 33 0;
#X connect 10 3 89 0;
#X connect 11 0 40 0;
#X connect 12 0 11 1;
#X connect 13 0 24 0;
#X connect 14 0 17 0;
#X connect 15 0 16 1;
#X connect 16 0 90 0;
#X connect 17 0 16 0;
#X connect 18 0 92 0;
#X connect 19 0 22 0;
#X connect 19 1 18 0;
#X connect 19 2 93 0;
#X connect 19 3 20 0;
#X connect 20 0 18 0;
#X connect 22 0 87 0;
#X connect 23 0 49 0;
#X connect 24 0 23 1;
#X connect 25 0 40 1;
#X connect 25 0 60 1;
#X connect 26 0 25 0;
#X connect 30 0 31 0;
#X connect 31 0 29 0;
#X connect 32 0 36 0;
#X connect 34 0 35 0;
#X connect 35 0 29 0;
#X connect 36 0 29 0;
#X connect 37 0 38 0;
#X connect 38 0 29 0;
#X connect 40 0 5 0;
#X connect 41 0 47 0;
#X connect 41 1 46 0;
#X connect 42 0 46 1;
#X connect 43 0 100 0;
#X connect 43 1 98 0;
#X connect 45 0 50 0;
#X connect 46 0 43 0;
#X connect 47 0 63 0;
#X connect 49 0 63 0;
#X connect 49 1 102 0;
#X connect 50 0 61 0;
#X connect 50 0 94 0;
#X connect 51 0 55 0;
#X connect 52 0 54 0;
#X connect 53 0 54 0;
#X connect 54 0 51 0;
#X connect 55 0 11 0;
#X connect 55 1 60 0;
#X connect 56 0 99 0;
#X connect 56 1 101 0;
#X connect 57 0 14 0;
#X connect 57 1 72 0;
#X connect 60 0 90 0;
#X connect 61 0 96 0;
#X connect 61 1 96 0;
#X connect 61 2 96 0;
#X connect 61 3 97 0;
#X connect 63 0 77 0;
#X connect 63 1 64 0;
#X connect 64 0 65 0;
#X connect 65 0 66 0;
#X connect 69 0 103 0;
#X connect 71 0 105 0;
#X connect 71 1 104 0;
#X connect 72 0 23 0;
#X connect 75 0 22 1;
#X connect 75 1 21 0;
#X connect 76 0 28 0;
#X connect 76 1 91 0;
#X connect 81 0 7 0;
#X connect 83 0 0 0;
#X connect 84 0 85 0;
#X connect 85 0 86 0;
#X connect 85 1 88 0;
#X connect 87 0 57 0;
#X connect 89 0 27 0;
#X connect 89 1 91 0;
#X connect 90 0 79 0;
#X connect 91 0 87 1;
#X connect 92 0 75 0;
#X connect 93 0 75 0;
#X connect 96 0 62 0;
#X connect 97 0 62 0;
#X connect 98 0 44 0;
#X connect 99 0 44 0;
#X connect 100 0 56 0;
#X connect 101 0 44 0;
#X connect 102 0 48 0;
#X connect 103 0 71 0;
#X connect 104 0 70 0;
#X connect 105 0 70 0;
